---
import Navigation from '../components/Navigation.astro';
import { getLangFromUrl, getDirection, getLanguageClass } from '../utils/i18n';
import '../styles/global.css';

export interface Props {
  title: string;
  description?: string;
}

const { title, description = "Arcom - The Accredited Arabian Company for Facilities Management" } = Astro.props;

// Get language from URL path
const lang = getLangFromUrl(Astro.url);
const direction = getDirection(lang);
const languageClass = getLanguageClass(lang);
const canonicalURL = Astro.site ? new URL(Astro.url.pathname, Astro.site) : Astro.url;
const isRTL = lang === 'ar';
---

<!DOCTYPE html>
<html lang={lang} dir={direction} class={languageClass}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    
    <title>{title}</title>
    <meta name="description" content={description} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content="/og-image.jpg" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:site_name" content="Arcom - أركوم" />
    <meta property="og:locale" content={lang === 'ar' ? 'ar_SA' : 'en_US'} />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content="/og-image.jpg" />
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    
    <!-- Theme -->
    <meta name="theme-color" content="#07D580" />
    <meta name="color-scheme" content="light" />
    
    <!-- Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Arcom - The Accredited Arabian Company for Facilities Management",
        "alternateName": "أركوم - الشركة العربية المعتمدة لإدارة المرافق",
        "url": "https://arcom.sa",
        "logo": "https://arcom.sa/logo.png",
        "description": "شريكك في التميز - حلول مبتكرة وموثوقة لإدارة وصيانة المرافق",
        "foundingDate": "2015",
        "foundingLocation": {
          "@type": "Place",
          "name": "Riyadh, Saudi Arabia"
        },
        "areaServed": {
          "@type": "Country",
          "name": "Saudi Arabia"
        },
        "serviceType": [
          "Facilities Management",
          "Operations & Maintenance",
          "Hospitality Services",
          "Housekeeping",
          "Airport Services",
          "Landscaping",
          "Home Care Services",
          "Renovations",
          "Pest Control"
        ],
        "contactPoint": {
          "@type": "ContactPoint",
          "email": "info@arcom.sa",
          "contactType": "Customer Service"
        }
      }
    </script>
    
    <!-- Preconnect to Google Fonts for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Load fonts based on language -->
    {lang === 'ar' ? (
      <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@200;300;400;500;700;800;900&display=swap" rel="stylesheet">
    ) : (
      <link href="https://fonts.googleapis.com/css2?family=Archivo:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&display=swap" rel="stylesheet">
    )}
    
    <!-- Language alternates -->
    <link rel="alternate" hreflang="ar" href={`${Astro.url.origin}/?lang=ar`} />
    <link rel="alternate" hreflang="en" href={`${Astro.url.origin}/?lang=en`} />
    <link rel="alternate" hreflang="x-default" href={`${Astro.url.origin}/?lang=ar`} />
  </head>
  
  <body class="min-h-screen bg-neutral-50 text-neutral-900 antialiased">
    <!-- Skip to main content for accessibility -->
    <a 
      href="#main-content" 
      class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary-500 text-white px-4 py-2 rounded-lg z-[100]"
    >
      {lang === 'ar' ? 'انتقل إلى المحتوى الرئيسي' : 'Skip to main content'}
    </a>
    
    <!-- Navigation -->
    <Navigation lang={lang} />
    
    <!-- Main Content -->
    <main id="main-content" class="pt-16 lg:pt-20">
      <slot />
    </main>
    
    <!-- Footer -->
    <footer class="bg-gray-900 text-white">
      <div class="container-custom section-padding">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
          <!-- Company Info -->
          <div class="lg:col-span-2">
            <div class="flex items-center space-x-3 rtl:space-x-reverse mb-6">
              <div class="w-12 h-12 bg-gradient-primary rounded-lg flex items-center justify-center shadow-lg">
                <span class="text-white font-bold text-xl">A</span>
              </div>
              <div>
                <div class="text-2xl font-bold">
                  {lang === 'ar' ? 'أركوم' : 'ARCOM'}
                </div>
                <div class="text-gray-400 text-sm">
                  {lang === 'ar' ? 'شريكك في التميز' : 'Your Excellence Partner'}
                </div>
              </div>
            </div>
            <p class="text-gray-300 mb-6 max-w-md">
              {lang === 'ar' 
                ? 'الشركة العربية المعتمدة لإدارة المرافق - نقدم حلول مبتكرة وموثوقة لإدارة وصيانة المرافق في المملكة العربية السعودية.'
                : 'The Accredited Arabian Company for Facilities Management - Delivering innovative and reliable facilities management solutions in Saudi Arabia.'
              }
            </p>
            <div class="flex space-x-4 rtl:space-x-reverse">
              <a href="mailto:info@arcom.sa" class="text-primary-400 hover:text-primary-300 transition-colors">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                  <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                </svg>
              </a>
              <a href="https://www.arcom.sa" class="text-primary-400 hover:text-primary-300 transition-colors">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.559-.499-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.559.499.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.497-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z" clip-rule="evenodd"></path>
                </svg>
              </a>
            </div>
          </div>
          
          <!-- Quick Links -->
          <div>
            <h3 class="text-lg font-semibold mb-6">
              {lang === 'ar' ? 'روابط سريعة' : 'Quick Links'}
            </h3>
            <ul class="space-y-3">
              <li><a href="#about" class="text-gray-300 hover:text-primary-400 transition-colors">{lang === 'ar' ? 'من نحن' : 'About'}</a></li>
              <li><a href="#services" class="text-gray-300 hover:text-primary-400 transition-colors">{lang === 'ar' ? 'الخدمات' : 'Services'}</a></li>
              <li><a href="#contact" class="text-gray-300 hover:text-primary-400 transition-colors">{lang === 'ar' ? 'اتصل بنا' : 'Contact'}</a></li>
            </ul>
          </div>
          
          <!-- Contact Info -->
          <div>
            <h3 class="text-lg font-semibold mb-6">
              {lang === 'ar' ? 'معلومات التواصل' : 'Contact Info'}
            </h3>
            <ul class="space-y-3 text-gray-300">
              <li class="flex items-center space-x-3 rtl:space-x-reverse">
                <svg class="w-5 h-5 text-primary-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                  <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                </svg>
                <span class="ltr-content">info@arcom.sa</span>
              </li>
              <li class="flex items-center space-x-3 rtl:space-x-reverse">
                <svg class="w-5 h-5 text-primary-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
                </svg>
                <span>{lang === 'ar' ? 'الرياض، المملكة العربية السعودية' : 'Riyadh, Saudi Arabia'}</span>
              </li>
              <li class="flex items-center space-x-3 rtl:space-x-reverse">
                <svg class="w-5 h-5 text-primary-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.559-.499-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.559.499.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.497-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z" clip-rule="evenodd"></path>
                </svg>
                <span class="ltr-content">www.arcom.sa</span>
              </li>
            </ul>
          </div>
        </div>
        
        <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
          <p class="text-gray-400 text-sm">
            {lang === 'ar' 
              ? `© ${new Date().getFullYear()} أركوم. جميع الحقوق محفوظة.`
              : `© ${new Date().getFullYear()} Arcom. All rights reserved.`
            }
          </p>
          <div class="flex items-center space-x-4 rtl:space-x-reverse mt-4 md:mt-0">
            <span class="text-gray-400 text-sm">
              {lang === 'ar' ? 'صنع بـ' : 'Made with'}
            </span>
            <span class="text-red-400">♥</span>
            <span class="text-gray-400 text-sm">
              {lang === 'ar' ? 'في المملكة العربية السعودية' : 'in Saudi Arabia'}
            </span>
          </div>
        </div>
      </div>
    </footer>
    
    <!-- Loading indicator -->
    <div id="loading" class="fixed inset-0 bg-white z-[9999] flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300">
      <div class="flex items-center space-x-3 rtl:space-x-reverse">
        <div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center animate-pulse">
          <span class="text-white font-bold">A</span>
        </div>
        <div class="text-lg font-medium text-gray-700">
          {lang === 'ar' ? 'جاري التحميل...' : 'Loading...'}
        </div>
      </div>
    </div>
    
    <!-- Analytics and tracking scripts would go here -->
    
    <script>
      // Add smooth loading animation
      document.addEventListener('DOMContentLoaded', () => {
        document.body.classList.add('loaded');
      });
      
      // Font loading optimization
      if ('fonts' in document) {
        Promise.all([
          document.fonts.load('400 1em Archivo'),
          document.fonts.load('600 1em Archivo'),
          document.fonts.load('700 1em Archivo'),
          document.fonts.load('400 1em Tajawal'),
          document.fonts.load('600 1em Tajawal'),
          document.fonts.load('700 1em Tajawal')
        ]).then(() => {
          document.body.classList.add('fonts-loaded');
        });
      }
    </script>
  </body>
</html>

<style>
  /* Font loading states */
  body {
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
  }
  
  body.loaded {
    opacity: 1;
  }
  
  /* Ensure proper font fallbacks during loading */
  .font-archivo {
    font-family: 'Archivo', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }
  
  .font-arabic {
    font-family: 'Tajawal', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }
  
  /* Optimize font rendering */
  body.fonts-loaded {
    font-display: swap;
  }
  
  /* RTL specific adjustments */
  [dir="rtl"] {
    text-align: right;
  }
  
  [dir="ltr"] {
    text-align: left;
  }
  
  /* Ensure proper number rendering in Arabic */
  [dir="rtl"] .ltr-numbers {
    direction: ltr;
    display: inline-block;
  }
</style> 